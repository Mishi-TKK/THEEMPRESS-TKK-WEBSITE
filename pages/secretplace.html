<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Secret Place</title>
    <link rel="stylesheet" href="../css/style.css">
    <!-- Font Awesome CSS (Ensure this is correctly linked if you want the icon) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* --- General Body Adjustments --- */
        body {
            padding-left: 200px; /* Start with space for sidebar */
            box-sizing: border-box;
            transition: padding-left 0.3s ease;
            padding-bottom: 70px; /* Increased padding for footer */
            margin: 0; /* Ensure no default margins */
            position: relative; /* Needed for absolute positioning context */
            min-height: 100vh; /* Ensure body takes full viewport height */
            color: #fff; /* Default text color */
        }
        body.collapsed {
            padding-left: 0; /* No padding when sidebar is hidden */
        }
        header {
            display: none; /* Hide default header on this page */
        }

        /* --- Video Background --- */
        .background-video {
            position: fixed; top: 0; left: 0;
            width: 100%; height: 100%;
            overflow: hidden; z-index: -2;
        }
        .background-video video {
            min-width: 100%; min-height: 100%;
            width: auto; height: auto;
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%); object-fit: cover;
        }
        /* Semi-transparent overlay */
        body::before {
            content: ''; position: fixed; top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.55); /* Slightly darker overlay */
            z-index: -1;
        }

        /* --- Gear Button --- */
        .gear-btn {
            position: fixed; top: 15px; left: 15px;
            background: none; border: none; color: white;
            cursor: pointer; font-size: 1.8rem; /* Slightly smaller */
            padding: 5px; z-index: 1001; opacity: 0.7;
            transition: color 0.3s ease, opacity 0.3s ease;
        }
        .gear-btn:hover { color: #ffd700; opacity: 1; }

        /* --- Side Navigation --- */
        .side-nav {
            position: fixed; top: 0; left: 0;
            width: 200px; height: 100%;
            background: rgba(106, 76, 147, 0.85);
            padding: 60px 20px 20px 20px; box-sizing: border-box;
            z-index: 1000; display: flex; flex-direction: column;
            align-items: center; transform: translateX(0);
            transition: transform 0.3s ease;
        }
        .side-nav.collapsed { transform: translateX(-200px); }
        .side-nav .nav-list {
            list-style: none; padding: 0; margin: 0;
            display: flex; flex-direction: column;
            align-items: flex-start; width: 100%;
        }
        .side-nav .nav-list li { margin-bottom: 15px; }
        .side-nav a {
            color: white; text-decoration: none;
            transition: color 0.3s ease;
            display: block; width: 100%; text-align: left;
        }
        .side-nav a:hover { color: #ffd700; }
                /* ======================================================== */
        /* === FIX for Nav Buttons inside the Side Navigation === */
        /* ======================================================== */

        /* Target the list items to make sure they fill the space */
        .side-nav .nav-list li {
            width: 100%; /* Make the <li> container fill the width */
        }

        /* Target ONLY the .nav-button class when it is inside .side-nav */
        .side-nav .nav-button {
            display: block; /* Ensures it takes up the full line */
            width: 100%; /* Makes the button fill the <li> container */
            box-sizing: border-box; /* Includes padding in the width calculation to prevent overflow */
            
            /* Adjust padding for a better vertical menu look */
            padding: 10px 15px; /* Less horizontal, more vertical padding */
            
            /* Align text to the left, which is standard for vertical menus */
            text-align: left;

            /* Allow long text like "Enter the Secret Place" to wrap */
            white-space: normal;
            word-wrap: break-word; /* Helps break long words if needed */
            
            /* Optional: slightly smaller font if still too crowded */
            font-size: 14px; /* Adjust as needed */
        }

        /* Override the hover effect for the sidebar buttons */
        .side-nav .nav-button:hover {
            transform: none; /* The 'lift' effect can look weird in a sidebar */
            /* The background and color change from your global .nav-button:hover will still apply, which is good! */
        }

        /* --- Content Area (Wrapper for Centering) --- */
        .content-area {
             display: flex;
             flex-direction: column;
             align-items: center;
             justify-content: center; 
             min-height: calc(100vh - 70px); /* Full height minus footer */
             padding: 30px 20px; 
             box-sizing: border-box;
        }

        /* --- Message Area (Moved Outside Gate) --- */
              /* --- Message Area Styling --- */
               /* --- Message Area Styling (Now Inside Gate) --- */
                /* --- Message Area Styling (Using Transform for Animation) --- */
        #message {
            /* Initially Hidden & Scaled Down */
            transform: scaleY(0); /* Collapse vertically */
            transform-origin: top; /* Scale down/up from the top */
            opacity: 0; 
            overflow: hidden; /* Hide content when scaled */
            background-color: transparent;
            border: 1px solid transparent;
            margin-top: 0;
            margin-bottom: 0;
            padding-top: 0;
            padding-bottom: 0;
            height: auto; /* Let content determine height when visible */

            /* Base Styles (Applied when visible) */
            width: 90%;
            max-width: 450px;
            margin-left: auto;
            margin-right: auto;
            color: #fff;
            font-style: italic;
            font-size: 1.0em;
            border-radius: 6px;
            text-align: center;

            /* Smooth transition for the scale/fade effect */
            transition: transform 0.4s ease-in-out, opacity 0.4s ease-in-out, margin 0.4s ease-in-out, padding 0.4s ease-in-out, background-color 0.4s ease, color 0.4s ease, border-color 0.4s ease;
        }

        /* Style for Visible Error Messages */
         #message.error {
              transform: scaleY(1); 
              opacity: 1; 
              padding-top: 10px;
              padding-bottom: 10px;
              margin-top: 15px; 
              margin-bottom: 15px; 
              /* NEW COLORS: Amber text, subtle orange background/border */
              color: #FFBF00; 
              background-color: rgba(255, 191, 0, 0.15); 
              border-color: rgba(255, 191, 0, 0.4); 
              font-weight: normal;
         }

        /* Style for Visible Success Messages */
        #message.success {
             transform: scaleY(1); 
             opacity: 1; 
             padding-top: 10px; 
             padding-bottom: 10px;
             margin-top: 15px; 
             margin-bottom: 15px; 
             font-weight: bold;
             color: #98FB98; 
             background-color: rgba(144, 238, 144, 0.3); 
             border-color: rgba(144, 238, 144, 0.6); 
        }
        /* --- Password Gate --- */
        .password-gate {
            position: relative; z-index: 1;
            padding: 30px; background-color: rgba(0, 0, 0, 0.65); /* Darker */
            border-radius: 8px; max-width: 700px; width: 90%;
            color: #fff; text-align: center;
            margin-bottom: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        .password-gate h2 {
             color: #ffd700; margin-bottom: 20px; font-size: 1.8em;
        }
        .password-gate p, .password-gate ul {
            text-align: left; margin-bottom: 15px; line-height: 1.7;
            font-size: 1.1em;
        }
        .password-gate ul { padding-left: 25px; list-style: disc; }
        .password-gate strong { color: #f0e68c; font-weight: 600; }
        .password-gate .scripture-ref {
             font-style: italic; color: #ccc;
             display: block; margin-top: 5px; margin-bottom: 15px;
             font-size: 0.95em; /* Slightly smaller */
        }
        .password-gate .input-area { /* Group input and buttons */
            margin-top: 25px;
        }

        /* Input/Button Styling */
        #passcode {
             margin-bottom: 15px;
             padding: 12px 15px;
             width: calc(100% - 34px); /* Adjust width for padding/border */
             max-width: 300px;
             border-radius: 4px; border: 1px solid #ccc;
             font-size: 1.1em; display: block; margin-left:auto; margin-right:auto; /* Center input */
        }
        .button-group { /* Container for buttons */
             display: flex;
             justify-content: center;
             gap: 15px; /* Space between buttons */
             margin-top: 15px;
             flex-wrap: wrap; /* Allow buttons to wrap on small screens */
        }
        /* Ensure .button class is defined in style.css or here */
        .button {
            padding: 12px 25px; font-size: 1.1em; cursor: pointer;
            background-color: #8A2BE2;
            color: white; border: none; border-radius: 5px;
            transition: background-color 0.3s ease;
        }
        .button:hover { background-color: #9932CC; } 
        /* Specific style for back button if needed */
        .back-button { background-color: #6c757d; } 
        .back-button:hover { background-color: #5a6268; }


        /* Secret Place Content Area */
        .secret-place-content {
            display: none; position: relative; z-index: 1;
            padding: 30px; background-color: rgba(0, 0, 0, 0.75); /* Darkest */
            border-radius: 8px; max-width: 700px; width: 90%;
            color: #fff; text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            margin-top: 20px; /* Add space if needed after message */
        }
        .secret-place-content h3{
            color: #ffd700; margin-bottom: 20px; font-size: 1.6em;
        }
        
        .secret-place-content textarea {
            width: 100%; min-height: 120px;
            margin-bottom: 15px; padding: 12px;
            box-sizing: border-box; border-radius: 4px;
            border: 1px solid #ccc; font-size: 1em;
        }
        #prayerResponse { margin-top: 15px; font-weight: bold; }
         #prayerResponse.success { color: #98FB98; }
         #prayerResponse.error { color: #FFCCCB; }
         #prayerResponse.processing { color: #ccc; font-style: italic;}


        /* --- Footer --- */
        footer {
            background-color: rgba(106, 76, 147, 0.9);
            color: #fff; text-align: center; padding: 1rem;
            width: 100%; box-shadow: 0 -2px 4px rgba(0, 0, 0, 0.2);
            position: fixed; bottom: 0; left: 0; z-index: 1000;
        }

        /* --- Responsive Adjustments --- */
        @media (max-width: 768px) {
            body { padding-left: 0; padding-bottom: 60px; }
            .side-nav, .gear-btn { display: none; }
            .password-gate, .secret-place-content, #message { max-width: 95%; width: 95%; }
            .content-area { padding: 15px 10px; min-height: calc(100vh - 50px); }
            footer { padding: 0.8rem; }
        }

        /* Optional Shake Animation */
         @keyframes shake-error {
           0%, 100% { transform: translateX(0); }
           10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
           20%, 40%, 60%, 80% { transform: translateX(5px); }
         }
        .shake-error {
          animation: shake-error 0.5s ease-in-out;
        }
        /* Optional Shake Animation */
         @keyframes shake-error {
           /* ... keyframe rules ... */
         }
        .shake-error {
          animation: shake-error 0.5s ease-in-out;
        }
/* ======================================================= */
/* === Mobile-Only Back Button for Secret Place Page === */
/* ======================================================= */

.mobile-back-button {
    display: none; /* Hidden by default on desktop */
    position: fixed;
    top: 15px;
    left: 15px;
    z-index: 1002; /* Ensure it's on top of everything */
    
    background-color: rgba(106, 76, 147, 0.85); 
    color: white;
    padding: 8px 15px;
    text-decoration: none;
    font-size: 14px;
    font-weight: bold;
    border-radius: 20px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    transition: background-color 0.3s ease;
}

.mobile-back-button:hover {
    background-color: #513a72; 
}

/* Media query to SHOW the button ONLY on mobile screens */
@media (max-width: 768px) {
    
    /* hide the desktop-only gear button on mobile */
    .gear-btn {
        display: none;
    }
}
       
    </style>
</head>
    </style>
</head>
<body>
    <body>
    <!-- ==== ADD THIS MOBILE-ONLY BACK BUTTON ==== -->
    <a href="/pages/cafe.html" class="mobile-back-button">« Back to Cafe</a>
    <!-- ======================================= -->

    <!-- Gear Button (for desktop) -->
    <button class="gear-btn" aria-label="Toggle Navigation"><i class="fas fa-bars"></i></button>

    

    <!-- Side Navigation -->
    <nav class="side-nav">
    <ul class="nav-list">
        <li><a href="/index.html" class="nav-button">Home</a></li>
         <li><a href="/pages/blog.html" class="nav-button">Blog</a></li>
         <li><a href="/pages/cafe.html" class="nav-button">Empress Cafe</a></li>
         <li><a href="/pages/secretplace.html" class="nav-button active">Enter the Secret Place</a></li>
         <li><a href="/pages/contact.html" class="nav-button">Contact</a></li>
         <li><a href="/pages/blog-archive.html" class="nav-button">Blog Archive</a></li>
    </ul>
    </nav>

    <!-- Video Background -->
    <div class="background-video">
<video autoplay loop playsinline>
  <source src="https://media.theempressforge.com/secret-place-final.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>


    </div>

    <!-- Main Content Area -->
    <div class="content-area">

       
        <!-- Password Gate -->
        <div class="password-gate">
            <h2>Welcome to the Threshold of the Secret Place</h2>

            <!-- ==== FULL INTRODUCTORY TEXT INSERTED HERE ==== -->
            <p>Hey Beloved Warrior Friend,</p>
            <p>You've found your way here, drawn perhaps by a desire for deeper connection, a quieter space away from the noise. This is the entrance to our <strong>Secret Place</strong> – a digital sanctuary intentionally set apart for communion with our Father through praise, worship, and heartfelt prayer.</p>
            <p><strong>What is this Space For?</strong></p>
            <ul>
                <li><strong>Praise & Worship:</strong> A place to lift our voices and hearts, perhaps reflecting on the music within or simply bringing your own sacrifice of praise.</li>
                <li><strong>Prayer:</strong> Most importantly, this is a space for prayer. It's where you can bring your burdens, your joys, your requests, knowing you're entering a space dedicated to seeking God's face.</li>
            </ul>
            <p><strong>Your Prayers Are Heard!</strong></p>
            <p>Never doubt that when you pray, as a precious child of God, your Father hears you! It's not about eloquent words, but a sincere heart reaching out to Him. The Bible assures us:</p>
            <p><span class="scripture-ref">📖 1 John 5:14-15 (KJV):</span> "And this is the confidence that we have in him, that, if we ask any thing according to his will, he heareth us: And if we know that he hear us, whatsoever we ask, we know that we have the petitions that we desired of him."</p>
            <p><span class="scripture-ref">📖 Matthew 7:7-8 (KJV):</span> "Ask, and it shall be given you; seek, and ye shall find; knock, and it shall be opened unto you: For every one that asketh receiveth; and he that seeketh findeth; and to him that knocketh it shall be opened."</p>
            <p><strong>Corporate Prayer & Agreement</strong></p>
            <p>While your individual connection with God is paramount, there's also incredible power when we agree together in prayer. Jesus promised:</p>
            <p><span class="scripture-ref">📖 Matthew 18:19-20 (KJV):</span> "Again I say unto you, That if two of you shall agree on earth as touching any thing that they shall ask, it shall be done for them of my Father which is in heaven. For where two or three are gathered together in my name, there am I in the midst of them."</p>
            <p>Within the Secret Place, you'll find a way to send prayer requests directly to me. If you choose to share, know that I will stand in agreement with you according to God's Word for the desired change, believing with you for His perfect will to be done. Please share only what you feel comfortable with, providing enough context for focused agreement.</p>
            <p><strong>Finding the Key</strong></p>
            <p>Access to this intimate space requires a password – a key whispered in clues woven throughout the blog posts here at The Empress's Forge. Why? Because this journey requires intentionality. This encourages us all to truly engage with the Word, meditate on the truths shared, and grow together. If you've been walking this path with us and reading closely, you may have already discovered the password needed to enter.</p>
            <p>Ready to step inside? Enter the password below. If not yet, keep exploring the blog – the clues await!</p>
             <!-- ==== END OF FULL INTRODUCTORY TEXT ==== -->

            <!-- Input/Button Area -->
           <!-- Input/Button Area -->
<div class="input-area">
    <input type="password" id="passcode" placeholder="Type the secret...">
    <!-- ==== MESSAGE DIV MOVED HERE ==== -->
    <div id="message"></div>
    <!-- =============================== -->
    <div class="button-group">
        <button id="whisper-btn" class="button">Enter Secret Place</button>
        <button class="button back-button" onclick="window.location.href='cafe.html'">Return to Empress Cafe</button>
     </div>
</div>
        </div> <!-- End Password Gate -->

        <!-- Secret Place Content (Prayer Form) -->
        <div class="secret-place-content">
            <h3>Submit Your Prayer Request 🙏</h3>
            <form id="prayerRequestForm">
    <textarea name="Prayer Request" placeholder="Write your prayer request here..." required></textarea>

    <!--Email Link-->
    <div style="margin-top: 15px; text-align: left;">
        <label for="email" style="display: block; margin-bottom: 5px; font-size: 0.9em; color: #ffd700; font-weight: bold;">
            Your Email (Optional, for follow-up):
        </label>
        <input type="email" id="email" name="Follow-up Email" placeholder="Enter your email address...">
    </div>
    <!-- ========================================== -->

    <button type="submit" class="button" style="margin-top: 20px;">Send Prayer Request</button>
</form>
            <div id="prayerResponse"></div>
        </div>

    </div> <!-- End Content Area -->

    <!-- Audio Elements -->
    <audio id="victory" src="../audio/hallelujah.mp3"></audio>

    <!-- Footer -->
    <footer>
        <p>© 2025 The Empress's Forge: The King's Heir Initiative. All Rights Reserved</p>
    </footer>

    <script>
        // --- DOM Elements ---
        const gearBtn = document.querySelector('.gear-btn');
        const sideNav = document.querySelector('.side-nav');
        const body = document.querySelector('body');
        const passcode = document.getElementById("passcode");
        const message = document.getElementById("message"); // Moved outside gate
        const victory = document.getElementById("victory");
        const whisperSong = document.getElementById("whisperSong");
        const passwordGate = document.querySelector('.password-gate');
        const secretPlaceContent = document.querySelector('.secret-place-content');
        const whisperBtn = document.getElementById("whisper-btn");
        const prayerForm = document.getElementById('prayerRequestForm');
        const prayerResponse = document.getElementById('prayerResponse');

        // --- Constants ---
        const scriptures = [
            "Matthew 7:13-14 (KJV): Enter ye in at the strait gate... few there be that find it.", // Shortened
            "Matthew 7:7-8 (KJV): Ask, and it shall be given you; seek, and ye shall find; knock, and it shall be opened unto you...",
            "Jeremiah 33:3 (KJV): Call unto Me, and I will answer thee, and show thee great and mighty things, which thou knowest not."
        ];
        const correctMessage = "Welcome to the Secret Place Remnant! The Gates have been Opened.";
        const correctPassword = "remnant";

        // --- Functions ---
                function displayMessage(text, type = 'neutral') {
             message.textContent = text;
             message.className = ''; // Clear previous classes
             if (type === 'success') {
                 message.classList.add('success');
             } else if (type === 'error') {
                 message.classList.add('error');
             }
             // Ensure message div is not accidentally hidden by JS (unlikely but possible)
             message.style.display = 'block'; // Redundant if CSS is correct, but safe
             message.style.visibility = 'visible'; // Redundant if CSS is correct, but safe

             // Log the final state
             console.log("Message Div Final State:", {
                 text: message.textContent.substring(0, 50) + "...", // Log beginning of text
                 className: message.className,
                 display: window.getComputedStyle(message).display,
                 visibility: window.getComputedStyle(message).visibility,
                 opacity: window.getComputedStyle(message).opacity,
                 color: window.getComputedStyle(message).color,
                 backgroundColor: window.getComputedStyle(message).backgroundColor
             });
        }


        function unlockSecret() {
            const enteredPasscode = passcode.value.toLowerCase().trim();

            if (enteredPasscode === correctPassword) {
                // Don't pause whisperSong unless desired
                victory.play();
                displayMessage(correctMessage, 'success'); // Display success message

                // Wait for sound before hiding gate
                setTimeout(() => {
            passwordGate.style.display = 'none';
            secretPlaceContent.style.display = 'block';
            
            // === ADD THESE THREE LINES ===
            //const mobileBackButton = document.querySelector('.mobile-back-button');
            //if (mobileBackButton) {
               // mobileBackButton.style.display = 'inline-block';
            //}
            // =============================
            
             // Hide the message after a further delay, or leave it visible
             // setTimeout(() => { message.textContent = ''; }, 5000); // Example: Hide after 5s
        }, 3000); // Adjust timing if Ha sound is longer/shorter

            } else {
                // Display scripture error message
                const randomScripture = scriptures[Math.floor(Math.random() * scriptures.length)];
                displayMessage(randomScripture, 'error');
                passcode.value = ""; // Clear incorrect password

                 // Optional: Add shake animation
                // passwordGate.classList.add('shake-error');
                 //setTimeout(() => passwordGate.classList.remove('shake-error'), 500);
            }
        }

               function handlePrayerSubmit(e) {
            e.preventDefault(); 
            const formData = new FormData(prayerForm);
            
            // Show a "sending..." message to the user.
            prayerResponse.textContent = 'Sending your request...';
            prayerResponse.className = 'processing'; 

            // The unique URL you get from your Formspree dashboard.
            
            const formspreeURL = 'https://formspree.io/f/xdkddjkv';

           
            fetch(formspreeURL, {
                method: 'POST',
                body: formData,
                headers: {
                    'Accept': 'application/json'
                }
            }).then(response => {
                if (response.ok) {
                    // SUCCESS! The email was sent by Formspree.
                    // Display your success message.
                    prayerResponse.textContent = "Thank you! Your prayer request has been received.";
                    prayerResponse.className = 'success'; 
                    prayerForm.reset(); // Clear the textarea.
                } else {
                    // ERROR! Formspree had a problem.
                    response.json().then(data => {
                        if (Object.hasOwn(data, 'errors')) {
                            // Display specific errors from Formspree if available.
                            prayerResponse.textContent = data["errors"].map(error => error["message"]).join(", ");
                        } else {
                            // Generic error message.
                            prayerResponse.textContent = "Oops! There was a problem submitting your request.";
                        }
                        prayerResponse.className = 'error'; // Use this class for styling.
                    });
                }
            }).catch(error => {
                // NETWORK ERROR! The user might be offline or the server is down.
                console.error('Network error submitting form:', error);
                prayerResponse.textContent = "There was a network problem. Please check your connection and try again.";
                prayerResponse.className = 'error';
            });
        }

        // --- Event Listeners ---
        if (gearBtn && sideNav && body) {
            gearBtn.addEventListener('click', () => {
                sideNav.classList.toggle('collapsed');
                body.classList.toggle('collapsed');
            });
        }

        if (whisperBtn) {
            whisperBtn.addEventListener("click", unlockSecret);
        }

        if (passcode) {
            passcode.addEventListener("keypress", (event) => {
                if (event.key === "Enter") {
                    event.preventDefault();
                    unlockSecret();
                }
            });
        }

        if (prayerForm) {
            prayerForm.addEventListener('submit', handlePrayerSubmit);
        }

        // --- Background Music Handling ---
         let musicStarted = false;
         function startMusic() {
             // Try playing only if it hasn't started or has ended (if not looping)
             if (!musicStarted || whisperSong.paused) {
                  // Check if context is suspended (common after page load)
                  if (whisperSong.readyState >= 2) { // HAVE_CURRENT_DATA or more
                     whisperSong.play().then(() => {
                         musicStarted = true;
                         console.log("Background music started/resumed.");
                         document.body.removeEventListener('click', startMusicInteraction); // Remove listener
                     }).catch(error => {
                         console.log("Autoplay/play failed. Needs interaction.", error);
                         // Keep listener active if failed
                     });
                  } else {
                       console.log("Audio not ready, waiting...");
                       whisperSong.addEventListener('canplay', startMusic, { once: true });
                  }
             }
         }
         // Need a separate function for the interaction listener
         function startMusicInteraction() {
             startMusic();
         }

         // Initial attempt
         startMusic();
         // Fallback listener for first interaction
         document.body.addEventListener('click', startMusicInteraction, { once: true });


    </script>
    <!-- Footer -->
    <footer>
        <p>© 2025 The Empress's Forge: The King's Heir Initiative. All Rights Reserved</p>
    </footer>
</body>
</html>